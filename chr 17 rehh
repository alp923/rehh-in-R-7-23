library(PopGenome)
library(rehh)
library(vcfR)

hh <- data2haplohh(hap_file = "/Users/lexiperez/Desktop/ABCC3.HC3202_chr17.49634881-51692253.vcf.gz", polarize_vcf = FALSE, vcf_reader = "data.table")
res <- calc_ehh(hh, mrk=1, include_nhaplo = TRUE)
#* Reading input file(s) *
#Using package 'data.table' to read vcf.
#Extracting map information.
#Extracting haplotypes.
#Number of individuals which are 
#Haploid Diploid Triploid, ... : 
#1 2 
#0 3202 
#No marker identifiers found in vcf file.
#* Filtering data *
#Discard markers genotyped on less than 100 % of haplotypes.
#39 markers discarded.
#1335 markers remaining.
#Data consists of 6404 haplotypes and 1335 markers.
#Number of mono-, bi-, multi-allelic markers:
#1 2 3 4 5 6 7 
#1 1265 53 7 6 2 1 

res <- calc_ehh(hh, mrk=1, include_nhaplo = TRUE)
res$freq
#      FREQ_A       FREQ_D 
#0.9998438476 0.0001561524 

res$ehh
# POSITION      EHH_A EHH_D NHAPLO_A NHAPLO_D
1   49634949 1.00000000     0     6403        1
2   49634976 0.60328255     0     6403        0
3   49634977 0.60305539     0     6403        0
4   49634989 0.60214750     0     6403        0
5   49635043 0.60169375     0     6403        0
6   49635065 0.60138179     0     6403        0
7   49635079 0.60115502     0     6403        0
8   49635103 0.60092829     0     6403        0
9   49635155 0.60070161     0     6403        0
10  49635222 0.59979568     0     6403        0
11  49635250 0.59956924     0     6403        0
12  49635273 0.59934286     0     6403        0
13  49635284 0.59925777     0     6403        0
14  49635383 0.59903143     0     6403        0
15  49635392 0.59880514     0     6403        0
16  49635416 0.59812662     0     6403        0
17  49635417 0.59767453     0     6403        0
18  49635422 0.59744854     0     6403        0
19  49635433 0.59541853     0     6403        0
20  49635500 0.59249259     0     6403        0
21  49635505 0.59226772     0     6403        0
22  49635507 0.59204290     0     6403        0
23  49635514 0.59181812     0     6403        0
24  49635571 0.59136877     0     6403        0
25  49635632 0.33436061     0     6403        0
26  49635653 0.32201332     0     6403        0
27  49635655 0.32171151     0     6403        0
28  49635658 0.31647961     0     6403        0
29  49635698 0.30584300     0     6403        0
30  49635751 0.29642380     0     6403        0
31  49635780 0.29635476     0     6403        0
32  49635794 0.29438925     0     6403        0
33  49635811 0.29432041     0     6403        0
34  49635815 0.29377718     0     6403        0
35  49635897 0.22423094     0     6403        0
36  49635903 0.22420191     0     6403        0
37  49635923 0.22414287     0     6403        0
38  49635924 0.22356969     0     6403        0
39  49635925 0.22354412     0     6403        0
40  49635927 0.22343503     0     6403        0
41  49635997 0.22319254     0     6403        0
42  49636065 0.22308354     0     6403        0
43  49636074 0.22308354     0     6403        0
44  49636081 0.22253807     0     6403        0
45  49636102 0.22251256     0     6403        0
46  49636104 0.22245362     0     6403        0
47  49636106 0.22245347     0     6403        0
48  49636116 0.22234203     0     6403        0
49  49636143 0.22204856     0     6403        0
50  49636163 0.22193991     0     6403        0
51  49636182 0.22163677     0     6403        0
52  49636207 0.22130856     0     6403        0
53  49636231 0.22123245     0     6403        0
54  49636245 0.22117405     0     6403        0
55  49636256 0.22117405     0     6403        0
56  49636266 0.22080744     0     6403        0
57  49636290 0.22036628     0     6403        0
58  49636300 0.22036301     0     6403        0
59  49636324 0.22033774     0     6403        0
60  49636347 0.22027968     0     6403        0
61  49636362 0.22022933     0     6403        0
62  49636373 0.22017132     0     6403        0
63  49636452 0.22006305     0     6403        0
64  49636472 0.21996352     0     6403        0
65  49636550 0.21819810     0     6403        0
66  49636615 0.21817327     0     6403        0
67  49636640 0.21792034     0     6403        0
68  49636644 0.21792034     0     6403        0
69  49636787 0.21786277     0     6403        0
70  49636811 0.21669576     0     6403        0
71  49636820 0.21630847     0     6403        0
72  49636920 0.21620132     0     6403        0
73  49636960 0.21615214     0     6403        0
74  49636983 0.21615214     0     6403        0
75  49637004 0.21611741     0     6403        0
76  49637011 0.21601031     0     6403        0
77  49637013 0.21595284     0     6403        0
78  49637137 0.21589541     0     6403        0
79  49637172 0.21578837     0     6403        0
80  49637175 0.21578837     0     6403        0
81  49637176 0.21578461     0     6403        0
82  49637197 0.21578461     0     6403        0
83  49637216 0.21324119     0     6403        0
84  49637232 0.21320816     0     6403        0
85  49637362 0.21319893     0     6403        0
86  49637414 0.21301827     0     6403        0
87  49637446 0.21301578     0     6403        0
88  49637458 0.21300660     0     6403        0
89  49637501 0.21299709     0     6403        0
90  49637508 0.20944254     0     6403        0
91  49637516 0.20943157     0     6403        0
92  49637540 0.20935760     0     6403        0
93  49637588 0.20857301     0     6403        0
94  49637602 0.20756779     0     6403        0
95  49637630 0.20563078     0     6403        0
96  49637650 0.20511243     0     6403        0
97  49637656 0.20508838     0     6403        0
98  49637680 0.20466064     0     6403        0
99  49637724 0.20282316     0     6403        0
100 49637733 0.20276895     0     6403        0
101 49637742 0.20266595     0     6403        0
102 49637828 0.20250885     0     6403        0
103 49637910 0.17394026     0     6403        0
104 49637924 0.17394026     0     6403        0
105 49637971 0.16528681     0     6403        0
106 49637994 0.16528120     0     6403        0
107 49638021 0.16509053     0     6403        0
108 49638108 0.16509043     0     6403        0
109 49638197 0.16405482     0     6403        0
110 49638248 0.16405482     0     6403        0
111 49638264 0.16403501     0     6403        0
112 49638276 0.16403164     0     6403        0
113 49638308 0.16401188     0     6403        0
114 49638345 0.16401188     0     6403        0
115 49638365 0.16401139     0     6403        0
116 49638373 0.16395582     0     6403        0
117 49638391 0.16390923     0     6403        0
118 49638458 0.16379755     0     6403        0
119 49638495 0.16256872     0     6403        0
120 49638526 0.16255657     0     6403        0
121 49638532 0.16251130     0     6403        0
122 49638569 0.16241938     0     6403        0
123 49638570 0.16237127     0     6403        0
124 49638578 0.13842406     0     6403        0
125 49638583 0.12827316     0     6403        0
126 49638657 0.12820792     0     6403        0
127 49638675 0.12811849     0     6403        0
128 49638696 0.12811195     0     6403        0
129 49638702 0.12809263     0     6403        0
130 49638706 0.12782722     0     6403        0
131 49638709 0.12782722     0     6403        0
132 49638727 0.12780794     0     6403        0
133 49638809 0.12778872     0     6403        0
134 49638817 0.12773051     0     6403        0
135 49638820 0.12768655     0     6403        0
136 49638881 0.12767924     0     6403        0
137 49638882 0.12757234     0     6403        0
138 49638885 0.12757195     0     6403        0
139 49638904 0.12757073     0     6403        0
140 49638928 0.12752691     0     6403        0
141 49638947 0.12743758     0     6403        0
142 49638948 0.12734898     0     6403        0
143 49638957 0.12734898     0     6403        0
144 49638983 0.12734898     0     6403        0
145 49638984 0.12734493     0     6403        0
146 49639090 0.12726311     0     6403        0
147 49639100 0.12726311     0     6403        0
148 49639225 0.12719529     0     6403        0
149 49639229 0.12701681     0     6403        0
150 49639239 0.12692763     0     6403        0
151 49639243 0.12689079     0     6403        0
152 49639249 0.12688225     0     6403        0
153 49639259 0.12674554     0     6403        0
154 49639267 0.12584644     0     6403        0
155 49639350 0.12580282     0     6403        0
156 49639461 0.12580282     0     6403        0
157 49639471 0.12389167     0     6403        0
158 49639510 0.12389050     0     6403        0
159 49639520 0.12376057     0     6403        0
160 49639547 0.12376057     0     6403        0
161 49639551 0.12367558     0     6403        0
162 49639589 0.12367548     0     6403        0
163 49639618 0.12358751     0     6403        0
164 49639670 0.12358117     0     6403        0
165 49639763 0.12357902     0     6403        0
166 49639872 0.12048891     0     6403        0
167 49639892 0.12048100     0     6403        0
168 49639899 0.12039435     0     6403        0
169 49639988 0.12039123     0     6403        0
170 49639998 0.12021924     0     6403        0
171 49639999 0.12017719     0     6403        0
172 49640040 0.11966548     0     6403        0
173 49640060 0.11934346     0     6403        0
174 49640075 0.11932483     0     6403        0
175 49640083 0.11932483     0     6403        0
176 49640122 0.11932483     0     6403        0
177 49640249 0.11932483     0     6403        0
178 49640252 0.11896193     0     6403        0
179 49640357 0.11887508     0     6403        0
180 49640361 0.11878536     0     6403        0
181 49640369 0.07515338     0     6403        0
182 49640395 0.07512645     0     6403        0
183 49640429 0.07505580     0     6403        0
184 49640432 0.07504795     0     6403        0
185 49640488 0.07497906     0     6403        0
186 49640577 0.07495701     0     6403        0
187 49640672 0.07495701     0     6403        0
188 49640723 0.07495701     0     6403        0
189 49640724 0.07495539     0     6403        0
190 49640725 0.07488245     0     6403        0
191 49640794 0.07486352     0     6403        0
192 49640799 0.07481429     0     6403        0
193 49640826 0.07275633     0     6403        0
194 49640925 0.07272945     0     6403        0
195 49641005 0.07272945     0     6403        0
196 49641033 0.07272881     0     6403        0
197 49641071 0.07266319     0     6403        0
198 49641108 0.06307854     0     6403        0
199 49641126 0.06305190     0     6403        0
200 49641149 0.06301892     0     6403        0
 [ reached 'max' / getOption("max.print") -- omitted 121 rows ]
 
 plot(res)
 res2 <- calc_ehh(hh, mrk=2, include_nhaplo = TRUE)
 
res2$freq
#   FREQ_A    FREQ_D 
#0.2726421 0.7273579 

res2$ehh
    POSITION     EHH_A      EHH_D NHAPLO_A NHAPLO_D
1   49634949 1.0000000 0.99957063     1746     4658
2   49634976 1.0000000 1.00000000     1746     4658
3   49634977 1.0000000 0.99957063     1746     4658
4   49634989 1.0000000 0.99785463     1746     4658
5   49635043 1.0000000 0.99699700     1746     4658
6   49635065 0.9988545 0.99656828     1746     4658
7   49635079 0.9988545 0.99613965     1746     4658
8   49635103 0.9988545 0.99571111     1746     4658
9   49635155 0.9988545 0.99528266     1746     4658
10  49635222 0.9988545 0.99357035     1746     4658
11  49635250 0.9988545 0.99314236     1746     4658
12  49635273 0.9988545 0.99271447     1746     4658
13  49635284 0.9977097 0.99271447     1746     4658
14  49635383 0.9977097 0.99228667     1746     4658
15  49635392 0.9977097 0.99185896     1746     4658
16  49635416 0.9977097 0.99057647     1746     4658
17  49635417 0.9977097 0.98972198     1746     4658
18  49635422 0.9977097 0.98929482     1746     4658
19  49635433 0.9977097 0.98545789     1746     4658
20  49635500 0.9977097 0.97992754     1746     4658
21  49635505 0.9977097 0.97950250     1746     4658
22  49635507 0.9977097 0.97907756     1746     4658
23  49635514 0.9977097 0.97865271     1746     4658
24  49635571 0.9977097 0.97780337     1746     4658
25  49635632 0.7927195 0.52064377     1746     4658
26  49635653 0.7784198 0.49931612     1746     4658
27  49635655 0.7784112 0.49874679     1746     4658
28  49635658 0.7774089 0.48899522     1746     4658
29  49635698 0.7774089 0.46889399     1746     4658
30  49635751 0.7774089 0.45109321     1746     4658
31  49635780 0.7774089 0.45096266     1746     4658
32  49635794 0.7774089 0.44724816     1746     4658
33  49635811 0.7774089 0.44711798     1746     4658
34  49635815 0.7774089 0.44609144     1746     4658
35  49635897 0.7774089 0.31465129     1746     4658
36  49635903 0.7774089 0.31459643     1746     4658
37  49635923 0.7774089 0.31448478     1746     4658
38  49635924 0.7774089 0.31340163     1746     4658
39  49635925 0.7774089 0.31335332     1746     4658
40  49635927 0.7774089 0.31314716     1746     4658
41  49635997 0.7764071 0.31282954     1746     4658
42  49636065 0.7764071 0.31262356     1746     4658
43  49636074 0.7764071 0.31262356     1746     4658
44  49636081 0.7764071 0.31159278     1746     4658
45  49636102 0.7764071 0.31154456     1746     4658
46  49636104 0.7764071 0.31143310     1746     4658
47  49636106 0.7764071 0.31143282     1746     4658
48  49636116 0.7764071 0.31122224     1746     4658
49  49636143 0.7764071 0.31066720     1746     4658
50  49636163 0.7764071 0.31046188     1746     4658
51  49636182 0.7764071 0.30988858     1746     4658
52  49636207 0.7764071 0.30926836     1746     4658
53  49636231 0.7764071 0.30912453     1746     4658
54  49636245 0.7764071 0.30901408     1746     4658
55  49636256 0.7764071 0.30901408     1746     4658
56  49636266 0.7764071 0.30832093     1746     4658
57  49636290 0.7764071 0.30748709     1746     4658
58  49636300 0.7764071 0.30748091     1746     4658
59  49636324 0.7764071 0.30743315     1746     4658
60  49636347 0.7764071 0.30732334     1746     4658
61  49636362 0.7764071 0.30722819     1746     4658
62  49636373 0.7764071 0.30711848     1746     4658
63  49636452 0.7764071 0.30691389     1746     4658
64  49636472 0.7754061 0.30686641     1746     4658
65  49636550 0.7754061 0.30352974     1746     4658
66  49636615 0.7754061 0.30348281     1746     4658
67  49636640 0.7754061 0.30300467     1746     4658
68  49636644 0.7754061 0.30300467     1746     4658
69  49636787 0.7754061 0.30289578     1746     4658
70  49636811 0.7711577 0.30128710     1746     4658
71  49636820 0.7691634 0.30083533     1746     4658
72  49636920 0.7691634 0.30063286     1746     4658
73  49636960 0.7691634 0.30053992     1746     4658
74  49636983 0.7691634 0.30053992     1746     4658
75  49637004 0.7691634 0.30047428     1746     4658
76  49637011 0.7691634 0.30027190     1746     4658
77  49637013 0.7691634 0.30016320     1746     4658
78  49637137 0.7691634 0.30005459     1746     4658
79  49637172 0.7691634 0.29985231     1746     4658
80  49637175 0.7691634 0.29985231     1746     4658
81  49637176 0.7691634 0.29984521     1746     4658
82  49637197 0.7691634 0.29984521     1746     4658
83  49637216 0.7666703 0.29538860     1746     4658
84  49637232 0.7666703 0.29532619     1746     4658
85  49637362 0.7665462 0.29532619     1746     4658
86  49637414 0.7665462 0.29498450     1746     4658
87  49637446 0.7665462 0.29497980     1746     4658
88  49637458 0.7664228 0.29497980     1746     4658
89  49637501 0.7664228 0.29496182     1746     4658
90  49637508 0.7664228 0.28824386     1746     4658
91  49637516 0.7664228 0.28822311     1746     4658
92  49637540 0.7654276 0.28822311     1746     4658
93  49637588 0.7644332 0.28688006     1746     4658
94  49637602 0.7644332 0.28498012     1746     4658
95  49637630 0.7644332 0.28131670     1746     4658
96  49637650 0.7644332 0.28033709     1746     4658
97  49637656 0.7644332 0.28029164     1746     4658
98  49637680 0.7644332 0.27948297     1746     4658
99  49637724 0.7644332 0.27601031     1746     4658
100 49637733 0.7644332 0.27590778     1746     4658
101 49637742 0.7644332 0.27571315     1746     4658
102 49637828 0.7644332 0.27541618     1746     4658
103 49637910 0.6583996 0.23631383     1746     4658
104 49637924 0.6583996 0.23631383     1746     4658
105 49637971 0.6583996 0.21995854     1746     4658
106 49637994 0.6583260 0.21995827     1746     4658
107 49638021 0.6583260 0.21959758     1746     4658
108 49638108 0.6583260 0.21959740     1746     4658
109 49638197 0.6583260 0.21763855     1746     4658
110 49638248 0.6583260 0.21763855     1746     4658
111 49638264 0.6583260 0.21760112     1746     4658
112 49638276 0.6583260 0.21759475     1746     4658
113 49638308 0.6583260 0.21755741     1746     4658
114 49638345 0.6583260 0.21755741     1746     4658
115 49638365 0.6583260 0.21755649     1746     4658
116 49638373 0.6583260 0.21745139     1746     4658
117 49638391 0.6583260 0.21736324     1746     4658
118 49638458 0.6583260 0.21715220     1746     4658
119 49638495 0.6583260 0.21482769     1746     4658
120 49638526 0.6582532 0.21481497     1746     4658
121 49638532 0.6582532 0.21472931     1746     4658
122 49638569 0.6582532 0.21455561     1746     4658
123 49638570 0.6582532 0.21446470     1746     4658
124 49638578 0.3375608 0.21425412     1746     4658
125 49638583 0.2740922 0.20398440     1746     4658
126 49638657 0.2740922 0.20386104     1746     4658
127 49638675 0.2740922 0.20369204     1746     4658
128 49638696 0.2740922 0.20367968     1746     4658
129 49638702 0.2740922 0.20364317     1746     4658
130 49638706 0.2740922 0.20314124     1746     4658
131 49638709 0.2740922 0.20314124     1746     4658
132 49638727 0.2740922 0.20310482     1746     4658
133 49638809 0.2740922 0.20306850     1746     4658
134 49638817 0.2737332 0.20300894     1746     4658
135 49638820 0.2737332 0.20292577     1746     4658
136 49638881 0.2737332 0.20291194     1746     4658
137 49638882 0.2737332 0.20270975     1746     4658
138 49638885 0.2737332 0.20270902     1746     4658
139 49638904 0.2737332 0.20270671     1746     4658
140 49638928 0.2737332 0.20262382     1746     4658
141 49638947 0.2737332 0.20245501     1746     4658
142 49638948 0.2726619 0.20243804     1746     4658
143 49638957 0.2726619 0.20243804     1746     4658
144 49638983 0.2726619 0.20243804     1746     4658
145 49638984 0.2726619 0.20243039     1746     4658
146 49639090 0.2721656 0.20234538     1746     4658
147 49639100 0.2721656 0.20234538     1746     4658
148 49639225 0.2718426 0.20226250     1746     4658
149 49639229 0.2718426 0.20192524     1746     4658
150 49639239 0.2718426 0.20175670     1746     4658
151 49639243 0.2713470 0.20175670     1746     4658
152 49639249 0.2713470 0.20174056     1746     4658
153 49639259 0.2713470 0.20148194     1746     4658
154 49639267 0.2713470 0.19978245     1746     4658
155 49639350 0.2713470 0.19969993     1746     4658
156 49639461 0.2713470 0.19969993     1746     4658
157 49639471 0.2713470 0.19608731     1746     4658
158 49639510 0.2713470 0.19608510     1746     4658
159 49639520 0.2707451 0.19592394     1746     4658
160 49639547 0.2707451 0.19592394     1746     4658
161 49639551 0.2707451 0.19576314     1746     4658
162 49639589 0.2707451 0.19576296     1746     4658
163 49639618 0.2707451 0.19559654     1746     4658
164 49639670 0.2707451 0.19558455     1746     4658
165 49639763 0.2707451 0.19558050     1746     4658
166 49639872 0.2707451 0.18973999     1746     4658
167 49639892 0.2706387 0.18973999     1746     4658
168 49639899 0.2706387 0.18957625     1746     4658
169 49639988 0.2706387 0.18957035     1746     4658
170 49639998 0.2706387 0.18924526     1746     4658
171 49639999 0.2706387 0.18916569     1746     4658
172 49640040 0.2706387 0.18819834     1746     4658
173 49640060 0.2706387 0.18758974     1746     4658
174 49640075 0.2706387 0.18755452     1746     4658
175 49640083 0.2706387 0.18755452     1746     4658
176 49640122 0.2706387 0.18755452     1746     4658
177 49640249 0.2706387 0.18755452     1746     4658
178 49640252 0.2701444 0.18693771     1746     4658
179 49640357 0.2701444 0.18677360     1746     4658
180 49640361 0.2701444 0.18660404     1746     4658
181 49640369 0.2701444 0.10411664     1746     4658
182 49640395 0.2701444 0.10406575     1746     4658
183 49640429 0.2701444 0.10393224     1746     4658
184 49640432 0.2700388 0.10393224     1746     4658
185 49640488 0.2700388 0.10380187     1746     4658
186 49640577 0.2700388 0.10376011     1746     4658
187 49640672 0.2700388 0.10376011     1746     4658
188 49640723 0.2700388 0.10376011     1746     4658
189 49640724 0.2700388 0.10375706     1746     4658
190 49640725 0.2700388 0.10361923     1746     4658
191 49640794 0.2700388 0.10358345     1746     4658
192 49640799 0.2695405 0.10356041     1746     4658
193 49640826 0.2665334 0.10009383     1746     4658
194 49640925 0.2665334 0.10004303     1746     4658
195 49641005 0.2665334 0.10004303     1746     4658
196 49641033 0.2665334 0.10004183     1746     4658
197 49641071 0.2660444 0.09998651     1746     4658
198 49641108 0.2660444 0.08186626     1746     4658
199 49641126 0.2660444 0.08181592     1746     4658
200 49641149 0.2660444 0.08175360     1746     4658
 [ reached 'max' / getOption("max.print") -- omitted 1135 rows ]
 
 plot(res2)
 
scan <- scan_hh(hh)
scan
      CHR POSITION    FREQ_A       FREQ_D NHAPLO_A NHAPLO_D IHH_A      IHH_D IES INES
1   chr17 49634949 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
2   chr17 49634976 0.2726421 0.7273579013     1746     4658    NA         NA  NA   NA
3   chr17 49634977 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
4   chr17 49634989 0.9993754 0.0006246096     6400        4    NA         NA  NA   NA
5   chr17 49635043 0.9996877 0.0003123048     6402        2    NA         NA  NA   NA
6   chr17 49635065 0.9996877 0.0003123048     6402        2    NA   592.2775  NA   NA
7   chr17 49635079 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
8   chr17 49635103 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
9   chr17 49635155 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
10  chr17 49635222 0.9993754 0.0006246096     6400        4    NA         NA  NA   NA
11  chr17 49635250 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
12  chr17 49635273 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
13  chr17 49635284 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
14  chr17 49635383 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
15  chr17 49635392 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
16  chr17 49635416 0.9995315 0.0003123048     6401        2    NA         NA  NA   NA
17  chr17 49635417 0.9993754 0.0003123048     6400        2    NA         NA  NA   NA
18  chr17 49635422 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
19  chr17 49635433 0.9985946 0.0014053716     6395        9    NA         NA  NA   NA
20  chr17 49635500 0.9979700 0.0012492192     6391        8    NA         NA  NA   NA
21  chr17 49635505 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
22  chr17 49635507 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
23  chr17 49635514 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
24  chr17 49635571 0.9996877 0.0003123048     6402        2    NA         NA  NA   NA
25  chr17 49635632 0.7126796 0.2743597751     4564     1757    NA         NA  NA   NA
26  chr17 49635653 0.9817302 0.0182698314     6287      117    NA         NA  NA   NA
27  chr17 49635655 0.9985946 0.0014053716     6395        9    NA         NA  NA   NA
28  chr17 49635658 0.9886009 0.0101499063     6331       65    NA         NA  NA   NA
29  chr17 49635698 0.9865709 0.0134291068     6318       86    NA         NA  NA   NA
30  chr17 49635751 0.9861024 0.0138975640     6315       89    NA         NA  NA   NA
31  chr17 49635780 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
32  chr17 49635794 0.9975016 0.0024984385     6388       16    NA         NA  NA   NA
33  chr17 49635811 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
34  chr17 49635815 0.9992192 0.0007807620     6399        5    NA         NA  NA   NA
35  chr17 49635897 0.8616490 0.1383510306     5518      886    NA         NA  NA   NA
36  chr17 49635903 0.9995315 0.0004684572     6401        3    NA  1936.5242  NA   NA
37  chr17 49635923 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
38  chr17 49635924 0.9987508 0.0012492192     6396        8    NA         NA  NA   NA
39  chr17 49635925 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
40  chr17 49635927 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
41  chr17 49635997 0.9995315 0.0004684572     6401        3    NA  2798.4075  NA   NA
42  chr17 49636065 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
43  chr17 49636074 0.9995315 0.0004684572     6401        3    NA         NA  NA   NA
44  chr17 49636081 0.9990631 0.0009369144     6398        6    NA         NA  NA   NA
45  chr17 49636102 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
46  chr17 49636104 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
47  chr17 49636106 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
48  chr17 49636116 0.9996877 0.0003123048     6402        2    NA 13507.8363  NA   NA
49  chr17 49636143 0.9992192 0.0007807620     6399        5    NA         NA  NA   NA
50  chr17 49636163 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
51  chr17 49636182 0.9987508 0.0012492192     6396        8    NA         NA  NA   NA
52  chr17 49636207 0.9993754 0.0006246096     6400        4    NA         NA  NA   NA
53  chr17 49636231 0.9995315 0.0004684572     6401        3    NA         NA  NA   NA
54  chr17 49636245 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
55  chr17 49636256 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
56  chr17 49636266 0.9989069 0.0010930668     6397        7    NA         NA  NA   NA
57  chr17 49636290 0.9992192 0.0007807620     6399        5    NA         NA  NA   NA
58  chr17 49636300 0.9996877 0.0003123048     6402        2    NA  5162.7988  NA   NA
59  chr17 49636324 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
60  chr17 49636347 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
61  chr17 49636362 0.9996877 0.0003123048     6402        2    NA         NA  NA   NA
62  chr17 49636373 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
63  chr17 49636452 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
64  chr17 49636472 0.9996877 0.0003123048     6402        2    NA  2539.9675  NA   NA
65  chr17 49636550 0.9962523 0.0037476577     6380       24    NA         NA  NA   NA
66  chr17 49636615 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
67  chr17 49636640 0.9990631 0.0009369144     6398        6    NA         NA  NA   NA
68  chr17 49636644 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
69  chr17 49636787 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
70  chr17 49636811 0.9970331 0.0029668957     6385       19    NA         NA  NA   NA
71  chr17 49636820 0.9992192 0.0007807620     6399        5    NA         NA  NA   NA
72  chr17 49636920 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
73  chr17 49636960 0.9996877 0.0003123048     6402        2    NA         NA  NA   NA
74  chr17 49636983 0.9995315 0.0004684572     6401        3    NA         NA  NA   NA
75  chr17 49637004 0.9995315 0.0004684572     6401        3    NA  4682.7508  NA   NA
76  chr17 49637011 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
77  chr17 49637013 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
78  chr17 49637137 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
79  chr17 49637172 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
80  chr17 49637175 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
81  chr17 49637176 0.9996877 0.0003123048     6402        2    NA  4485.6862  NA   NA
82  chr17 49637197 0.9996877 0.0003123048     6402        2    NA         NA  NA   NA
83  chr17 49637216 0.9937539 0.0062460962     6364       40    NA         NA  NA   NA
84  chr17 49637232 0.9943785 0.0056214866     6368       36    NA         NA  NA   NA
85  chr17 49637362 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
86  chr17 49637414 0.9993754 0.0006246096     6400        4    NA         NA  NA   NA
87  chr17 49637446 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
88  chr17 49637458 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
89  chr17 49637501 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
90  chr17 49637508 0.9926608 0.0073391630     6357       47    NA         NA  NA   NA
91  chr17 49637516 0.9996877 0.0003123048     6402        2    NA 10651.6138  NA   NA
92  chr17 49637540 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
93  chr17 49637588 0.9984385 0.0015615240     6394       10    NA         NA  NA   NA
94  chr17 49637602 0.9975016 0.0024984385     6388       16    NA         NA  NA   NA
95  chr17 49637630 0.9921924 0.0078076202     6354       50    NA         NA  NA   NA
96  chr17 49637650 0.9989069 0.0010930668     6397        7    NA         NA  NA   NA
97  chr17 49637656 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
98  chr17 49637680 0.9989069 0.0010930668     6397        7    NA         NA  NA   NA
99  chr17 49637724 0.9962523 0.0037476577     6380       24    NA         NA  NA   NA
100 chr17 49637733 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
 [ reached 'max' / getOption("max.print") -- omitted 1235 rows ]
 
#now i will compute the iHS value, also known as the summary of the EHH values over a region. 
scan <- scan_hh(hh, polarized=FALSE)
ihs <- ihh2ihs(scan, freqbin=1)
Discard focal markers with Minor Allele Frequency equal to or below 0.05 .
1287 markers discarded.
48 markers remaining.

ihs
$ihs
       CHR POSITION        IHS  LOGPVALUE
2    chr17 49634976         NA         NA
25   chr17 49635632         NA         NA
35   chr17 49635897         NA         NA
103  chr17 49637910         NA         NA
124  chr17 49638578         NA         NA
125  chr17 49638583         NA         NA
142  chr17 49638948         NA         NA
181  chr17 49640369         NA         NA
193  chr17 49640826         NA         NA
198  chr17 49641108         NA         NA
277  chr17 49642736         NA         NA
312  chr17 49643653         NA         NA
322  chr17 49643932         NA         NA
385  chr17 49645867         NA         NA
420  chr17 49646850         NA         NA
434  chr17 49647115         NA         NA
452  chr17 49647347  1.7567452 1.10258603
471  chr17 49647819         NA         NA
546  chr17 49650110  0.5022210 0.21076341
568  chr17 49650737         NA         NA
574  chr17 49651197         NA         NA
576  chr17 49651241         NA         NA
616  chr17 49652644         NA         NA
738  chr17 49656031 -0.1366615 0.04997691
791  chr17 49657696         NA         NA
891  chr17 49660367         NA         NA
908  chr17 49660740         NA         NA
921  chr17 49661184 -1.3328872 0.73857338
933  chr17 49661680 -0.9522665 0.46729425
948  chr17 49662013  0.8378680 0.39566070
955  chr17 49662162         NA         NA
1041 chr17 49664915 -0.4593618 0.18978469
1050 chr17 49665136         NA         NA
1055 chr17 49665277 -0.2156572 0.08131191
1069 chr17 49665479         NA         NA
1075 chr17 49665653         NA         NA
1076 chr17 49665659         NA         NA
1080 chr17 49665699         NA         NA
1102 chr17 49666458         NA         NA
1150 chr17 49667178         NA         NA
1161 chr17 49667293         NA         NA
1194 chr17 49667931         NA         NA
1224 chr17 49668775         NA         NA
1248 chr17 49669075         NA         NA
1260 chr17 49669429         NA         NA
1273 chr17 49669763         NA         NA
1277 chr17 49669922         NA         NA
1284 chr17 49670286         NA         NA

$frequency.class
            N_MRK MEAN_UNIHS  SD_UNIHS    LOWER_QT  UPPER_QT
[0.05,0.95)    48  0.2691873 0.2868006 -0.09398207 0.7269043

library(ggplot2)
ggplot(ihs$ihs, aes(POSITION, LOGPVALUE)) + geom_point()

dim(scan)
[1] 1335   10

 
 
